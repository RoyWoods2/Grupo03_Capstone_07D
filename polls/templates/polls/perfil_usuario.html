{% extends "polls/detail.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'polls/css/styleProfile.css' %}">

<div class="perfil-container">
    <!-- Encabezado del perfil -->
    <div class="perfil-header">
        <img src="{{ profile.avatar.url|default:'https://via.placeholder.com/150' }}" alt="{{ profile.nick }}" class="avatar">
        <h2>{{ profile.nick }}</h2>
        {% if profile.user == request.user %}
            <p class="perfil-rol">Tu perfil</p>
        {% else %}
            <p class="perfil-rol">Usuario registrado</p>
        {% endif %}
    </div>

    <!-- Informaci칩n b치sica -->
    <div class="perfil-info">
        <h3>Informaci칩n General</h3>
        <p><strong>Nombre:</strong> {{ profile.user.first_name|default:"No especificado" }}</p>
        <p><strong>Apellido:</strong> {{ profile.user.last_name|default:"No especificado" }}</p>
        <p><strong>Email:</strong> {{ profile.user.email }}</p>
        <p><strong>Puntos:</strong> {{ profile.user.puntos }}</p>
    </div>

    <!-- Historial de comentarios -->
    <div class="perfil-comentarios">
        <h3>Historial de Comentarios</h3>
        {% if comentarios %}
            <ul>
                {% for comentario in comentarios %}
                    <li>{{ comentario.contenido }} - {{ comentario.fecha_publicacion|date:"d M Y" }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Este usuario no tiene comentarios registrados.</p>
        {% endif %}
    </div>

    <!-- Formulario de edici칩n (solo para el usuario propietario) -->
    {% if request.user == profile.user %}
    <div class="perfil-editar">
        <h3>Editar Perfil</h3>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </form>
    </div>
    {% endif %}
</div>
{% endblock %}
