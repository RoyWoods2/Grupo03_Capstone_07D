{% extends "polls/detail.html" %}
{% load static %}
{% load polls_filters %}

{% block content %}
<link rel="stylesheet" href="{% static 'polls/css/styleProfile.css' %}">

<div class="perfil-container">
    <div class="perfil-header">
        <img src="{{ profile.avatar.url|default:'https://via.placeholder.com/150' }}" alt="{{ profile.nick }}" class="avatar">
        <h2>{{ profile.nick }}</h2>
    </div>
    <div class="perfil-info">
        <h3>Informaci√≥n General</h3>
        <p><strong>Nombre:</strong> {{ profile.name|default:"No especificado" }}</p>
        <p><strong>Email:</strong> {{ profile.email }}</p>
        <p><strong>Puntos:</strong> {{ profile.puntos }}</p>
        <h3>Personajes Favoritos</h3>
        <ul>
            {% for personaje in profile.personajes_favoritos.all %}
                <li>{{ personaje.nombre }}</li>
            {% endfor %}
        </ul>
        {% if profile.twitch_stream %}
        {% if twitch_embed_url %}
        <h3>Stream de Twitch</h3>
        <iframe src="https://player.twitch.tv/?channel={{ profile.twitch_stream|strip_twitch }}&parent=127.0.0.1" frameborder="0" allowfullscreen="true" scrolling="no" height="315" width="560"></iframe>
        {% endif %}    {% endif %}
    
        {% if profile.youtube_channel %}
        <div class="perfil-youtube">
            <h3>Canal de YouTube</h3>
            <a href="{{ profile.youtube_channel }}" target="_blank">
                <img src="{% static 'polls/icons/youtube.svg' %}" alt="YouTube" class="youtube-icon">
            </a>
        </div>
    {% else %}
        <p>No se ha configurado un canal de YouTube para este usuario.</p>
    {% endif %}
    </div>

   
    {% if request.user == profile %}
        <div class="perfil-editar">
            <h3>Editar Perfil</h3>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" name="update_profile" class="btn btn-primary">Guardar Cambios</button>
            </form>
        </div>
    {% endif %}
</div>
{% endblock %}